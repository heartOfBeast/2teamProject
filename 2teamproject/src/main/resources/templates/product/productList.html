<!doctype html>
<html
	xmlns:th="http://www.thymeleaf.org"
 	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="@{layout/default}">
<title th:text="${title}"></title>

<th:block layout:fragment="pageTitle">
<div class="page-header">
	<ol class="breadcrumb">
		<li class="breadcrumb-item">6/20 수정/상품관리</li>
		<li class="breadcrumb-item active">상품목록</li>
	</ol>

	<ul class="app-actions">
		<li>
			<a href="#" id="reportrange">
				<span class="range-text"></span>
				<i class="icon-chevron-down"></i>	
			</a>
		</li>
		<li>
			<a href="#">
				<i class="icon-export"></i>
			</a>
		</li>
	</ul>
</div>
</th:block>

<th:block layout:fragment="container">
	<!-- Main container start -->
<div class="main-container">
			<div class="row gutters">
				<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
					<div class="table-container">
						<div class="t-header">상품목록</div>
						<div class="table-responsive">
							<table id="copy-print-csv" class="table custom-table">
								<thead>
									<tr>
								      <th>
									  		<input type="checkbox" id="checkAll" style="position: relative; top: 1.5px;">
									  </th>
									  <th>상품코드</th>
									  <th>상품명</th>
									  <th>보관유형</th>
									  <th>대분류</th>
									  <th>중분류</th>
									  <th>소분류</th>
									  <th>추가분류</th>
									  <th>상품무게</th>
									  <th>제조일자</th>
									  <th>유통기한</th>
									  <th>등록자</th>
									  <th>수정</th>
									</tr>
								</thead>
								<tbody>
									<tr th:each="l : ${productList}">
									  <td>
								  	  	<input type="checkbox" class="checkOne" style="position: relative; top: 1.5px;" th:value="${l.productCode}">
									  </td>
									  <td th:text="${l.productCode}"></td>
									  <td th:text="${l.productName}"></td>
									  <td th:text="${l.productFreezeCoolCondition}"></td>
									  <td th:text="${l.item.itemBigCategory}"></td>
									  <td th:text="${l.item.itemMiddleCategory}"></td>
									  <td th:text="${l.item.itemSmallCategory}"></td>
									  <td th:text="${l.productAddCategory}"></td>
									  <td th:text="${l.productWeight}"></td>
									  <td th:text="${l.productDateOfManufacture}"></td>
									  <td th:text="${l.productExpirationDate}"></td>
									  <td th:text="${l.shoppingmallUserId}"></td>
									  <td>
									  	<a th:href="@{modifyProduct(productCode=${l.productCode})}">수정</a>
								  	  </td>
									</tr>
									<tr th:unless="${#lists.size(productList)>0}" style="text-align: center;">
										<td th:text="${검색 결과가 없습니다.}" colspan="11"></td>
									</tr>
								</tbody>
				    	</table>
							<button type="button" class="btn btn-primary float-right" onclick="deleteDate();">삭제</button>
						</div>
					</div>
				
				</div>
			</div>
		</div>

	<!-- Main container end -->

</th:block>
<th:block layout:fragment="customJs">
	<script>
			$(function(){
				$('#checkAll').click(function(){
					if($('#checkAll').prop('checked')){
						$('.checkOne').prop('checked', true);
					}else{
						$('.checkOne').prop('checked', false);
					}
				})
			})
			function deleteDate(){
				var dataArr = new Array();
				var list = $('.checkOne');
				for(var i=0; i<list.length; i++){
					if(list[i].checked){
						dataArr.push(list[i].value);
					}
				}
				if(dataArr.length == 0){
					alert('삭제할 항목을 선택해주세요.');
				}
				else{
					var chk = confirm('정말 삭제하시겠습니까?');
					if(chk){
						$.ajax({
							url : "/deleteSafetyCheck",
							method : 'post',
							async : true,
							dataType : "json",
							data : {'dataArr':dataArr},
							success: function(jdata){
								if(jdata != 1){
									alert('오류 : 삭제 실패');
								}else{
									alert('삭제 되었습니다.');
									location.replace("productList");
								}
							}
				    	});
					}else{
						return false;
					}
						
					
				}
			}
			
	</script>
</th:block>		
</html>