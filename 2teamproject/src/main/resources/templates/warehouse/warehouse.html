<!doctype html>
<html
	xmlns:th="http://www.thymeleaf.org"
 	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="@{layout/default}">
	
<th:block layout:fragment="pageTitle">
<div class="page-header">
	<ol class="breadcrumb">
		<li class="breadcrumb-item">창고</li>
		<li class="breadcrumb-item active">창고현황</li>
	</ol>

	<ul class="app-actions">
		<li>
			<a href="#" id="reportrange">
				<span class="range-text"></span>
				<i class="icon-chevron-down"></i>	
			</a>
		</li>
		<li>
			<a href="#">
				<i class="icon-export"></i>
			</a>
		</li>
	</ul>
</div>
		
</th:block>

<th:block layout:fragment="container">
<div class="main-container">
	<div class="row gutters">
		<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
			<div class="card" style="width:1650px; height:750px;">
				<div class="card-header">
					<div class="card-title">전국창고현황</div>
				</div>
				<div class="card-body">
					<div id="map" style="width:1600px;height:650px;"></div>
				</div>
			</div>
		</div>
	</div>
</div>
</th:block>

<th:block layout:fragment="customJs">
<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=cb83fa3281ae2832bdd855af7e467813" ></script>

<script type="text/javascript" th:inline="javascript">

/********************************************* map test *********************************************/
	var mapContainer = document.getElementById('map'), // 지도를 표시할 div  
	mapOption = { 
	    center: new kakao.maps.LatLng(36.35111, 127.38500), // 지도의 중심좌표
	    level: 13// 지도의 확대 레벨
	};

	var map = new kakao.maps.Map(mapContainer, mapOption); // 지도를 생성합니다
	var positions = [];
	$.ajax({
	url: "/getWarehouseLocation",
	method: "POST",
	dataType: "json",
	success: function(data){
 	console.log(data);
		
		for (var i = 0; i < data.length; i++){
			positions.push({
				title: data[i].warehouseName,
				address: data[i].warehouseAddr,
				latlng: new kakao.maps.LatLng(data[i].warehouseLat, data[i].warehouseLon),
			});
		}
	},
	error: function(request, status, error){
		console.log('error');
	},
	async: false
	});
	    
	var imageSrc = "https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/markerStar.png"; 
	for (var i = 0; i < positions.length; i ++) {
	    // 마커 이미지의 이미지 크기 입니다
	    var imageSize = new kakao.maps.Size(24, 35); 
	    // 마커 이미지를 생성합니다    
	    var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize); 
	    // 마커를 생성합니다
	    var marker = new kakao.maps.Marker({
	        map: map, // 마커를 표시할 지도
	        position: positions[i].latlng, // 마커를 표시할 위치
	        title : positions[i].title, // 마커의 타이틀, 마커에 마우스를 올리면 타이틀이 표시됩니다
	        image : markerImage // 마커 이미지 
	    });
   
 	    kakao.maps.event.addListener(marker, 'click', function() {
  	        alert('test');
  	    });

 		}
	
	
	
/* for (var i = 0; i < positions.length; i ++) {
    // 마커 생성
    var marker = new kakao.maps.Marker({
        map: map, // 마커를 표시할 지도
        position: positions[i].latlng // 마커의 위치
    });
    
    kakao.maps.event.addListener(marker, 'click', function() {
        alert('test');
    });
    
    // 마커에 표시할 인포윈도우를 생성합니다 
    var infowindow = new kakao.maps.InfoWindow({
        content: positions[i].content // 인포윈도우에 표시할 내용
    });

    // 마커에 mouseover 이벤트와 mouseout 이벤트를 등록합니다
    // 이벤트 리스너로는 클로저를 만들어 등록합니다 
    // for문에서 클로저를 만들어 주지 않으면 마지막 마커에만 이벤트가 등록됩니다
    kakao.maps.event.addListener(marker, 'mouseover', makeOverListener(map, marker, infowindow));
    kakao.maps.event.addListener(marker, 'mouseout', makeOutListener(infowindow));
	}
		
	
	// 인포윈도우를 표시하는 클로저를 만드는 함수입니다 
	function makeOverListener(map, marker, infowindow) {
	    return function() {
	        infowindow.open(map, marker);
	    };
	}
	
	// 인포윈도우를 닫는 클로저를 만드는 함수입니다 
	function makeOutListener(infowindow) {
	    return function() {
	        infowindow.close();
	    };
	} */
</script>
</th:block>

		
</html>