<!doctype html>
<html
	xmlns:th="http://www.thymeleaf.org"
 	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="@{layout/default}">
<th:block layout:fragment="pageTitle">
<div class="page-header">
	<ol class="breadcrumb">
		<li class="breadcrumb-item">재무관리</li>
		<li class="breadcrumb-item active">지출관리</li>
	</ol>

	<ul class="app-actions">
		<li>
			<a href="#" id="reportrange">
				<span class="range-text"></span>
				<i class="icon-chevron-down"></i>	
			</a>
		</li>
		<li>
			<a href="#">
				<i class="icon-export"></i>
			</a>
		</li>
	</ul>
</div>

<th:block layout:fragment="container">
<div class="main-container">
	<div class="row gutters">
							<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">

					
							<div class="card">
								<div class="card-header">
									<div class="card-title">월별 지출현황(그래프)</div>
								</div>
								<div class="card-body">
									<div id="basic-column-stack-graph-fullheight" class="primary-graph"></div>
								</div>
							</div>

					

						</div>
				
					<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
							
						<div class="table-container">
							<div class="t-header">월별 지출현황(표)</div>
								<div class="table-responsive">
									<table id="copy-print-csv" class="table custom-table">
										<thead>
											<tr>
												<th>
									  		<input type="checkbox" id="expenseCheckAll" style="position: relative; top: 1.5px;">
									  			</th>
												<th>지출코드</th>
												<th>지출내역</th>
												<th>지출날짜</th>
												<th>현금카드</th>
												<th>카드정보</th>
												<th>매장명</th>
												<th>종류</th>
												<th>금액</th>
												<th>등록자</th>
												<th>등록일</th>
												<th>수정</th>
											
											</tr>
										</thead>
										<tbody>
											<tr th:each="L :${expenditureList}">
												 <td>
								  	  	<input type="checkbox" class="expenseCheckOne" style="position: relative; top: 1.5px;" th:value="${L.expenseCode}">
									  			</td>
												<td th:text ="${L.expenseCode}"></td>
												<td th:text ="${L.expenseInfo}"></td>
												<td th:text ="${L.expenseDate}"></td>
												<td th:text ="${L.expenseCashCard}"></td>
												<td th:text ="${L.expenseCardInfo}"></td>
												<td th:text ="${L.expenseStore}"></td>
												<td th:text ="${L.expenseCate}"></td>
												<td th:text ="${L.expensePayment}"></td>
												<td th:text ="${L.wareadminId}"></td>
												<td th:text ="${L.expensRegDate}"></td>
												<td></td>
											
											</tr>
										</tbody>
									</table>
								<button type="button" class="btn btn-primary float-right" onclick="deleteDate();">삭제</button>
									
							</div>
							</div>
					</div>
	</div>
</div>
</th:block>
<th:block layout:fragment="customJs">
	<script>
	<script>
	/**********************************************************************************/
	window.onload = function(){
		
	var options = {
		  chart: {
		    height: 350,
		    type: 'bar',
		    stacked: true,
		    stackType: '100%',
		    toolbar: {
		      show: false
		    },
		    zoom: {
		      enabled: true
		    }
		  },
		  responsive: [{
		    breakpoint: 480,
		    options: {
		      legend: {
		        position: 'bottom',
		        offsetX: -10,
		        offsetY: 0
		      }
		    }
		  }],
		  plotOptions: {
		    bar: {
		      horizontal: false,
		    },
		  },
		  dataLabels: {
		    enabled: true
		  },
		  series: [{
		    name: '식료품2',
		    data: [44, 55, 41, 67, 22, 43]
		  },{
		    name: '비품2',
		    data: [13, 23, 20, 8, 13, 27]
		  },{
		    name: '임금2',
		    data: [11, 17, 15, 15, 21, 14]
		  },{
		    name: '생필품2',
		    data: [21, 7, 25, 13, 22, 8]
		  }],
		  xaxis: {
		    type: 'datetime',
		    categories: ['01/01/2011 GMT', '01/02/2011 GMT', '01/03/2011 GMT', '01/04/2011 GMT', '01/05/2011 GMT', '01/06/2011 GMT'],
		  },
		  legend: {
		    position: 'top',
		    offsetY: 10
		  },
		  fill: {
		    opacity: 1
		  },
		  colors: ['#1646b3', '#194eca', '#225de4', '#4274e8', '#628cec', '#81a3f0'],
		}
		var chart2 = new ApexCharts(
		  document.querySelector("#basic-column-stack-graph-fullheight2"),
		  options
		);
		chart2.render();
	}



	
	/**********************************************************************************/
			$(function(){
				$('#expenseCheckAll').click(function(){
					if($('#expenseCheckAll').prop('checked')){
						$('.expenseCheckOne').prop('checked', true);
					}else{
						$('.expenseCheckOne').prop('checked', false);
					}
				})
			})
			function deleteDate(){
				var dataArr = new Array();
				var list = $('.expenseCheckOne');
				for(var i=0; i<list.length; i++){
					if(list[i].checked){
						dataArr.push(list[i].value);
					}
				}
				if(dataArr.length == 0){
					alert('삭제할 항목을 선택해주세요.');
				}
				else{
					var chk = confirm('정말 삭제하시겠습니까?');
					if(chk){
						$.ajax({
							url : "/expenditureDelete",
							method : 'post',
							async : true,
							dataType : "json",
							data : {'dataArr':dataArr},
							success: function(jdata){
								if(jdata != 1){
									alert('오류 : 삭제 실패');
								}else{
									alert('삭제 되었습니다.');
									location.replace("expenditure");
								}
							}
				    	});
					}else{
						return false;
					}
						
					
				}
			}
			
	</script>

		
</html>