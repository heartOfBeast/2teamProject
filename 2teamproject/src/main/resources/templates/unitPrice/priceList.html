<!DOCTYPE html>
<html
	xmlns:th="http://www.thymeleaf.org"
 	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="@{layout/default}">
	
<th:block layout:fragment="pageTitle">
	<div class="page-header">
	<ol class="breadcrumb">
		<li class="breadcrumb-item">Shoppingmall</li>
		<li class="breadcrumb-item active">PriceList</li>
	</ol>

	<ul class="app-actions">
		<li>
			<a href="#" id="reportrange">
				<span class="range-text"></span>
				<i class="icon-chevron-down"></i>	
			</a>
		</li>
		<li>
			<a href="#">
				<i class="icon-export"></i>
			</a>
		</li>
	</ul>
</div>
</th:block>

<th:block layout:fragment="container">
	<div class="table-container">
		<div class="table-responsive">
			<button type="button" class="btn btn-primary float-right" onclick="deleteDate();">삭제</button>
			<button type="button" class="btn btn-primary float-right" onclick="location.href='priceAdd'">등록</button>
			<button type="button" class="btn btn-primary float-right" onclick="location.href='contractAdd'">계약신청</button>
			<table class="table custom-table m-0">
				<thead>
					<tr>
						<th>
					  		<input type="checkbox" id="priceCheck" style="position: relative; top: 1.5px;">
					    </th>
						<!-- <th>계약 코드</th> -->
						<th>계약 이름</th>
						<th>창고 종류</th>
						<th>계약 종류</th>
						<th>물품 개당 무게</th>
						<th>제한 수량</th>
						<th>구역 개수</th>
						<th>계약 기간</th>
						<th>사용 요금</th>
						<!-- <th>등록 날짜</th> -->
						<th>수정</th>
					</tr>
				</thead>
				<tbody>
					<tr th:each="l: ${priceList}">
						<td>
				  	  		<input type="checkbox" class="checkOne" style="position: relative; top: 1.5px;" th:value="${l.priceCode}" >
					    </td>
						<td style="display: none;"  th:text="${l.priceCode}" 			id="priceCodeData"></td>
						<td 						th:text="${l.priceName}" 			id="priceNameData"></td>
						<td 						th:text="${l.wareHouseType}" 		id="wareHoseTypeData"></td>
						<td 						th:text="${l.contractType}"			id="contractTypeData"></td>
						<td 						th:text="${l.priceWeight}" 			id="priceWeightData"></td>
						<td 						th:text="${l.priceNumber}"			id="priceNumberData" ></td>
						<td 						th:text="${l.priceZone}"			id="priceZoneData"></td>
						<td 						th:text="${l.priceDay}" 			id="priceDayData"></td>
						<td 						th:text="${l.pricePrice}"			id="priceData"></td>
						<td style="display: none;"  th:text="${l.unitPriceUpdate}"		id="unitPriceUpdateData"></td>
						<td>
							<!-- <a th:href="@{/priceUpdate(price_Code=${l.price_Code})}" >수정</a> -->
							<a type="button" class="btn btn-primary priceBtn" data-toggle="modal" data-target=".bd-example-modal-lg" id="viewModel" style="color: white;">수정</a>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
<form th:action="@{/priceUpdate}" method="post">
	<div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" style="display: none;" aria-hidden="true">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="myLargeModalLabel">수정하기</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">×</span>
					</button>
				</div>
				<div class="modal-body">
					<div class="form-group">
						<label for="priceCodeModel">계약코드</label>
						<input class="form-control" id="priceCodeModel" name="priceCode" />	
					</div>	
					<div class="form-group">
						<label for="priceNameModel">계약이름</label>	
						<input class="form-control" id="priceNameModel" name="priceName" />
					</div>	
					<div class="form-group">
						<label for="wareHoseTypeModel">창고종류</label>	
						<input class="form-control" id="wareHoseTypeModel" name="wareHouseType" />
					</div>
					<div class="form-group">
						<label for="contractTypeModel">계약 종류</label>	
						<input class="form-control" id="contractTypeModel" name="contractType" />
					</div>
					<div class="form-group">
						<label for="priceWeightModel">물품 개당 무게</label>	
						<input class="form-control" id="priceWeightModel" name="priceWeight" />
					</div>
					<div class="form-group">
						<label for="priceNumberModel">제한 수량</label>
						<input class="form-control" id="priceNumberModel" name="priceNumber" />
					</div>
					<div class="form-group">
						<label for="priceZoneModel">구역 개수</label>
						<input class="form-control" id="priceZoneModel" name="priceZone" />
					</div>
					<div class="form-group">
						<label for="priceDayModel">계약 기간</label>
						<input class="form-control" id="priceDayModel" name="priceDay" />
					</div>
					<div class="form-group">
						<label for="priceModel">사용 요금</label>
						<input class="form-control" id="priceModel" name="pricePrice" />
					</div>
					<input type="hidden" class="form-control" id="unitPriceUpdateModel" name="unitPriceUpdate" />
				</div>
				<div class="modal-footer">
					<button class="btn btn-secondary" data-dismiss="modal">취소</button>
					<button type="submit" name="submit"  class="btn btn-primary">수정</button>
				</div>
			</div>
		</div>
	</div>
</form>		

</th:block>
<th:block layout:fragment="customJs">
	<script>
			$(function(){
				$('#priceCheck').click(function(){
					if($('#priceCheck').prop('checked')){
						$('.checkOne').prop('checked', true);
					}else{
						$('.checkOne').prop('checked', false);
					}
				})
			})
			function deleteDate(){
				var dataArr = new Array();
				var list = $('.checkOne');
				for(var i=0; i<list.length; i++){
					if(list[i].checked){
						dataArr.push(list[i].value);
					}
				}
				if(dataArr.length == 0){
					alert('삭제할 항목을 선택해주세요.');
				}
				else{
					var chk = confirm('정말 삭제하시겠습니까?');
					if(chk){
						$.ajax({
							url : "/priceRemove",
							method : 'post',
							async : true,
							dataType : "json",
							data : {'dataArr':dataArr},
							success: function(jdata){
								if(jdata != 1){
									alert('오류 : 삭제 실패');
								}else{
									alert('삭제 되었습니다.');
									location.replace("priceList");
								}
							}
				    	});
					}else{
						return false;
					}
						
					
				}
			}
			$('.priceBtn').each(function(){
				$(this).click(function(){
					var priceCodeData 		= $(this).parents('tr').children('#priceCodeData').text();
					var priceNameData 		= $(this).parents('tr').children('#priceNameData').text();
					var wareHoseTypeData	= $(this).parents('tr').children('#wareHoseTypeData').text();
					var contractTypeData 	= $(this).parents('tr').children('#contractTypeData').text();
					var priceWeightData 	= $(this).parents('tr').children('#priceWeightData').text();
					var priceNumberData 	= $(this).parents('tr').children('#priceNumberData').text();
					var priceZoneData 		= $(this).parents('tr').children('#priceZoneData').text();
					var priceDayData 		= $(this).parents('tr').children('#priceDayData').text();
					var priceData 			= $(this).parents('tr').children('#priceData').text();
					var unitPriceUpdateData = $(this).parents('tr').children('#unitPriceUpdateData').text();
					
					/* var firesafetySelected = $('#fireInspection option:contains(' + facilityFiresafetyData + ')').val();
					var logisticsDataSelected = $('#logisticsInspㅇection option:contains(' + facilityLogisticsData + ')').val();
					var equipemntDataSelected = $('#equipmentInspection option:contains(' + facilityMainEquipemntData + ')').val(); */
					
					$('#priceCodeModel').val(priceCodeData);
					$('#priceNameModel').val(priceNameData);
					$('#wareHoseTypeModel').val(wareHoseTypeData);
					$('#contractTypeModel').val(contractTypeData);
					$('#priceWeightModel').val(priceWeightData);
					$('#priceNumberModel').val(priceNumberData);
					$('#priceZoneModel').val(priceZoneData);
					$('#priceDayModel').val(priceDayData);
					$('#priceModel').val(priceData);
					$('#unitPriceUpdateModel').val(unitPriceUpdateData);
				})
			})
	</script>
</th:block>
</html>